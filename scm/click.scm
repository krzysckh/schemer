(use "core")

; this can (for now) only register click objects that are rectangles.

; list of '(rect f drawf)
; so: '((rect1 f1 drawf1) (rect2 f2 drawf2))
; so: '((((0 0) (1 1)) a-function draw-function) ...)
(define click-objs '())

; rect <- '((x1 y1) (x2 y2))
(define on-click
  (lambda (rect f drawf)
    (set! click-objs (append click-objs (list `(,rect ,f ,drawf))))))

; execute that in (update-screen)
(define handle-click
  (lambda ()
    (for-each
      (lambda (v)
        ((list-ref v 2)))
      click-objs) ; draw objects

    (if (is-mouse-pressed 0)
      (for-each
        (lambda (v)
          (if (point-in-rect? (get-mouse-pos) (list-ref v 0))
            ((list-ref v 1)))) ; execute the f
        click-objs)
      #f)))
